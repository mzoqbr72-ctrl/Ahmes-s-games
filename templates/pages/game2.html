{% extends "base.html" %}

{% block ahmed %}
    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XO Game - Tic Tac Toe</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            width: 100%;
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            color: #f1c40f;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #ecf0f1;
            margin-bottom: 20px;
        }
        
        .game-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 40px;
            width: 100%;
        }
        
        .game-board {
            width: 400px;
            height: 400px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .cell {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 70px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .cell:hover {
            background-color: rgba(255, 255, 255, 1);
            transform: scale(1.03);
        }
        
        .cell.x {
            color: #e74c3c;
        }
        
        .cell.o {
            color: #3498db;
        }
        
        .cell.win {
            animation: winAnimation 1s infinite alternate;
            background-color: #2ecc71;
        }
        
        @keyframes winAnimation {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }
        
        .controls {
            background-color: rgba(44, 62, 80, 0.8);
            padding: 25px;
            border-radius: 15px;
            width: 350px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .status {
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.5rem;
            padding: 15px;
            border-radius: 10px;
            background-color: #34495e;
            width: 100%;
            font-weight: bold;
        }
        
        .score-board {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 25px;
        }
        
        .score {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            width: 45%;
        }
        
        .score-x {
            background-color: #e74c3c;
        }
        
        .score-o {
            background-color: #3498db;
        }
        
        .score-label {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .score-value {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
        }
        
        button {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        button i {
            margin-right: 10px;
        }
        
        .btn-new-game {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }
        
        .btn-new-game:hover {
            background: linear-gradient(135deg, #27ae60, #219653);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .btn-reset:hover {
            background: linear-gradient(135deg, #c0392b, #a93226);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .btn-mode {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }
        
        .btn-mode:hover {
            background: linear-gradient(135deg, #e67e22, #d35400);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .game-info {
            margin-top: 40px;
            background-color: rgba(44, 62, 80, 0.8);
            padding: 25px;
            border-radius: 15px;
            width: 100%;
            max-width: 800px;
        }
        
        .game-info h2 {
            color: #f1c40f;
            margin-bottom: 20px;
            text-align: center;
            font-size: 2rem;
        }
        
        .rules-list {
            list-style-type: none;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .rules-list li {
            background-color: #34495e;
            padding: 20px;
            border-radius: 10px;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .rules-list li i {
            color: #f1c40f;
            margin-right: 10px;
            font-size: 1.3rem;
        }
        
        @media (max-width: 900px) {
            .game-container {
                flex-direction: column;
                align-items: center;
            }
            
            .game-board {
                width: 350px;
                height: 350px;
            }
            
            .controls {
                width: 350px;
            }
        }
        
        @media (max-width: 500px) {
            .game-board {
                width: 300px;
                height: 300px;
            }
            
            .cell {
                font-size: 60px;
            }
            
            .controls {
                width: 300px;
            }
            
            h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>XO Game</h1>
            <p class="subtitle">The classic Tic Tac Toe game with a modern twist</p>
        </header>
        
        <div class="game-container">
            <div class="game-board" id="gameBoard">
                <!-- Cells will be generated by JavaScript -->
            </div>
            
            <div class="controls">
                <div class="status" id="status">Player X's Turn</div>
                
                <div class="score-board">
                    <div class="score score-x">
                        <div class="score-label">Player X</div>
                        <div class="score-value" id="scoreX">0</div>
                    </div>
                    
                    <div class="score score-o">
                        <div class="score-label">Player O</div>
                        <div class="score-value" id="scoreO">0</div>
                    </div>
                </div>
                
                <div class="buttons">
                    <button class="btn-new-game" id="newGameBtn">
                        <i class="fas fa-plus-circle"></i> New Game
                    </button>
                    <button class="btn-reset" id="resetScoreBtn">
                        <i class="fas fa-redo"></i> Reset Score
                    </button>
                    <button class="btn-mode" id="switchModeBtn">
                        <i class="fas fa-users"></i> vs Computer
                    </button>
                </div>
            </div>
        </div>
        
        <div class="game-info">
            <h2>How to Play</h2>
            <ul class="rules-list">
                <li><i class="fas fa-check-circle"></i> The game is played on a 3x3 grid</li>
                <li><i class="fas fa-check-circle"></i> Player X goes first, then Player O</li>
                <li><i class="fas fa-check-circle"></i> The first player to get 3 of their marks in a row (up, down, across, or diagonally) wins</li>
                <li><i class="fas fa-check-circle"></i> When all 9 squares are full, the game is over. If no player has 3 marks in a row, the game ends in a tie</li>
            </ul>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const gameBoard = document.getElementById('gameBoard');
            const statusElement = document.getElementById('status');
            const scoreXElement = document.getElementById('scoreX');
            const scoreOElement = document.getElementById('scoreO');
            const newGameBtn = document.getElementById('newGameBtn');
            const resetScoreBtn = document.getElementById('resetScoreBtn');
            const switchModeBtn = document.getElementById('switchModeBtn');
            
            let currentPlayer = 'X';
            let gameState = ['', '', '', '', '', '', '', '', ''];
            let gameActive = true;
            let scores = { X: 0, O: 0 };
            let vsComputer = false;
            
            // Winning combinations
            const winningConditions = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // rows
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // columns
                [0, 4, 8], [2, 4, 6]             // diagonals
            ];
            
            // Initialize the game board
            function initializeBoard() {
                gameBoard.innerHTML = '';
                for (let i = 0; i < 9; i++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.setAttribute('data-index', i);
                    cell.addEventListener('click', () => handleCellClick(i));
                    gameBoard.appendChild(cell);
                }
                
                resetGame();
            }
            
            // Reset game state without resetting scores
            function resetGame() {
                gameState = ['', '', '', '', '', '', '', '', ''];
                gameActive = true;
                currentPlayer = 'X';
                
                document.querySelectorAll('.cell').forEach(cell => {
                    cell.textContent = '';
                    cell.classList.remove('x', 'o', 'win');
                });
                
                updateStatus();
            }
            
            // Handle cell click
            function handleCellClick(index) {
                if (!gameActive || gameState[index] !== '') return;
                
                // Make move for human player
                makeMove(index, currentPlayer);
                
                // Check for win or draw
                if (checkWin()) {
                    handleWin();
                    return;
                }
                
                if (checkDraw()) {
                    handleDraw();
                    return;
                }
                
                // Switch player
                currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
                updateStatus();
                
                // If playing against computer and it's computer's turn
                if (vsComputer && gameActive && currentPlayer === 'O') {
                    setTimeout(makeComputerMove, 600);
                }
            }
            
            // Make a move
            function makeMove(index, player) {
                gameState[index] = player;
                const cell = document.querySelector(`.cell[data-index="${index}"]`);
                cell.textContent = player;
                cell.classList.add(player.toLowerCase());
            }
            
            // Computer makes a move
            function makeComputerMove() {
                if (!gameActive) return;
                
                // Simple AI: try to win, then block, then random move
                let move = findWinningMove('O') || findWinningMove('X') || findRandomMove();
                
                if (move !== null) {
                    makeMove(move, 'O');
                    
                    if (checkWin()) {
                        handleWin();
                        return;
                    }
                    
                    if (checkDraw()) {
                        handleDraw();
                        return;
                    }
                    
                    currentPlayer = 'X';
                    updateStatus();
                }
            }
            
            // Find a winning move for the specified player
            function findWinningMove(player) {
                for (let condition of winningConditions) {
                    const [a, b, c] = condition;
                    if (gameState[a] === player && gameState[b] === player && gameState[c] === '') return c;
                    if (gameState[a] === player && gameState[c] === player && gameState[b] === '') return b;
                    if (gameState[b] === player && gameState[c] === player && gameState[a] === '') return a;
                }
                return null;
            }
            
            // Find a random available move
            function findRandomMove() {
                const availableMoves = gameState.map((value, index) => value === '' ? index : null).filter(val => val !== null);
                if (availableMoves.length === 0) return null;
                return availableMoves[Math.floor(Math.random() * availableMoves.length)];
            }
            
            // Check for a win
            function checkWin() {
                for (let condition of winningConditions) {
                    const [a, b, c] = condition;
                    if (gameState[a] && gameState[a] === gameState[b] && gameState[a] === gameState[c]) {
                        // Highlight winning cells
                        document.querySelector(`.cell[data-index="${a}"]`).classList.add('win');
                        document.querySelector(`.cell[data-index="${b}"]`).classList.add('win');
                        document.querySelector(`.cell[data-index="${c}"]`).classList.add('win');
                        return true;
                    }
                }
                return false;
            }
            
            // Check for a draw
            function checkDraw() {
                return !gameState.includes('');
            }
            
            // Handle win
            function handleWin() {
                gameActive = false;
                scores[currentPlayer]++;
                updateScores();
                statusElement.textContent = `Player ${currentPlayer} Wins!`;
            }
            
            // Handle draw
            function handleDraw() {
                gameActive = false;
                statusElement.textContent = "Game ended in a draw!";
            }
            
            // Update status
            function updateStatus() {
                statusElement.textContent = vsComputer && currentPlayer === 'O' 
                    ? "Computer's Turn" 
                    : `Player ${currentPlayer}'s Turn`;
            }
            
            // Update score display
            function updateScores() {
                scoreXElement.textContent = scores.X;
                scoreOElement.textContent = scores.O;
            }
            
            // Switch game mode
            function switchMode() {
                vsComputer = !vsComputer;
                switchModeBtn.innerHTML = vsComputer 
                    ? '<i class="fas fa-user"></i> vs Player' 
                    : '<i class="fas fa-users"></i> vs Computer';
                resetGame();
            }
            
            // Reset scores
            function resetScores() {
                scores = { X: 0, O: 0 };
                updateScores();
                resetGame();
            }
            
            // Event listeners
            newGameBtn.addEventListener('click', resetGame);
            resetScoreBtn.addEventListener('click', resetScores);
            switchModeBtn.addEventListener('click', switchMode);
            
            // Initialize the game
            initializeBoard();
        });
    </script>
</body>
</html>
{% endblock ahmed %}
